<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Credit Snapshot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>

    <h1>Upload Credit Snapshot</h1>
    <p>Mint a provable credit score snapshot as an NFT on the blockchain.</p>

    <form id="uploadForm">
        <label for="wallet_address">Wallet Address:</label>
        <input type="text" id="wallet_address" name="wallet_address" placeholder="0x..." required>

        <label for="credit_score">Credit Score (300-850):</label>
        <input type="number" id="credit_score" name="credit_score" min="300" max="850" required>

        <button type="submit">Mint Snapshot</button>
    </form>

    <p id="result"></p>

    <script>
    document.getElementById("uploadForm").addEventListener("submit", async (event) => {
        event.preventDefault();

        const wallet_address = document.getElementById("wallet_address").value;
        const credit_score = document.getElementById("credit_score").value;

        const response = await fetch("/upload_credit_report", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ wallet_address, credit_score: parseInt(credit_score) })
        });

        const result = await response.json();
        if (result.error) {
            document.getElementById("result").innerText = result.error;
        } else if (result.redirect_url) {
            window.location.href = result.redirect_url;
        }
    });
    </script>

</body>
</html>
